
#! Electrostatic potential and electric field evaluated on a grid around d2s.

molecule d2s {
1 2
 noreorient
 nocom
    S            0.250254404867     0.126248114412     0.000000000000
    H            0.428893090449     1.055731838795     0.000000000000
    H            1.104987458381    -0.280303532167     0.000000000000
}



# Make a regular grid to evaluate properties on
xmax = 10.0
xmin = -xmax

ymax = 10.0
ymin = -ymax

zmax = 10.0
zmin = -zmax

dz = 0.2
dx = 0.2
dy = 0.2

nx = int((xmax-xmin)/dx)
ny = int((ymax-ymin)/dy)
nz = int((zmax-zmin)/dz)

with open('grid.dat', 'w') as fp:
    for i in range(nx+1):
        xpoint = xmin + i * dx
        for j in range(ny+1):
          ypoint = ymin + j * dy
          for k in range(nz+1):
            zpoint = zmin + k * dz
            fp.write("%16.10f%16.10f%16.10f\n" % (xpoint, ypoint, zpoint))

set basis 6-31G**
set reference uhf

E, wfn = prop('scf', properties=["GRID_ESP"], return_wfn=True)
Vvals = wfn.oeprop.Vvals()
